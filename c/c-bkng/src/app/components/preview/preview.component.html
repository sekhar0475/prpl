<section class="preview_sec">
  <div class="container">
    <div class="preview_main_card">
      <section class="mgsg_print_sec">
        <div class="row" style="position: relative;">
          <div class="col-md-3">
            <div class="row">
              <div class="col-md-6">
                <p style="cursor: pointer !important;" (click)="sendEmail()"><img alt="img"src="../assets/images/envelope.png"> <strong>Email</strong></p>
              </div>
              <div class="col-md-6">
                  <button style="cursor: pointer !important;width: 12rem;font-size: 2.8rem; border: none; background: transparent;left:0; top: 0.7rem; display: flex;" [useExistingCss]="true"
                  printTitle="{{previewList?.companyName}}" printSectionId="previewContent" ngxPrint> <img alt="img"src="../assets/images/printer.png"> <p style="font-weight: bold;">Print</p></button>
              </div>
            </div>
          </div> 
          <div class="col-md-1 col-md-offset-7" *ngIf="!editflow">
            <button mat-button class="theme-button" *ngxPermissionsOnly="['VIEW CONTRACT_CREATE','VIEW CONTRACT_UPDATE']" (click)="sendContractId($event)">Submit</button>
          </div>
          <div class="col-md-3 col-md-offset-6" *ngIf="editflow">
            <button mat-button class="theme-button pull-right" *ngxPermissionsOnly="['VIEW CONTRACT_CREATE','VIEW CONTRACT_UPDATE']" (click)="openEditPreview()">Verify Updated Changes</button>
          </div>
            <div class="backButton" (click)="closePreview($event)">
              <span>
                <mat-icon>close</mat-icon>
              </span>
            </div>
        </div>
      </section>
      <div id="previewContent" #previewContent class="width-800">
        <section class="preview_sec_1 width-800">
          <div class="row">
            <div class="col-md-6">
              <h3 class="booking_associate_heading"><strong>Booking Associate Contract</strong></h3>
            </div>
            <div class="col-md-6 text-right">
              <h4 class="Preview_generate_heading" *ngIf="currDate">Preview Generated on: {{currDate | date: 'dd MMM yy'}}</h4>
              <h4 class="Preview_generate_heading"*ngIf="!currDate">Preview Generated on: {{ 'NA'}}</h4>
            </div>
          </div>
        </section>
        <section class="preview_sec_2 width-800">
          <div class="row">
            <div class="col-md-6">
              <h3 class="font-thin break-word"><strong class="strong-text row_center">Organisation Name :</strong> {{previewList?.companyName ? previewList?.companyName : 'NA'}}</h3>
              <h3 class="font-thin break-word"><strong class="strong-text">Associate Category :</strong> {{previewList?.asscoCtrgy ? previewList?.asscoCtrgy : 'NA'}}</h3>
            </div>
            <div class="col-md-6">
              <div class="text_right">
                <h3 class="font-thin break-word"><strong class="strong-text">Contract Code :</strong> {{previewList?.cntrCode ? previewList?.cntrCode : 'NA'}}</h3>
                <h3 class="font-thin break-word"><strong class="strong-text">W.E.F :</strong> {{previewList?.wefDate == null ? 'NA' : previewList?.wefDate | date: 'dd/MM/yyyy'}}</h3>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3  width-800">
          <h3><strong>Contract Details</strong></h3>
          <div class="row">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Start Date</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4 flex4">{{previewList?.effectiveDt == null ? 'NA' : previewList?.effectiveDt | date: 'dd/MM/yyyy'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Billing Cycle</div>
                  <div class="mat-cell preview_table_bg_2 flex4 flex4">{{previewList?.billingCyle == null ? 'NA' : previewList?.billingCyle}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Shuttle Vendor</div>
                  <div class="mat-cell preview_table_bg_2 flex4 flex4">{{previewList?.shuttleVendorFlag === 1 ? 'YES' : 'NO'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>End Date</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.expDt == null ? 'NA' : previewList?.expDt | date: 'dd/MM/yyyy'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Status</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.cntrctStatus == "EDIT" ? "ACTIVE" : previewList?.cntrctStatus}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4  width-800">
          <h3><strong>Allocation</strong></h3>
          <h3 style="font-weight: bold;"> Branch</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl preview_table_2 pb_tb"  style="page-break-inside: avoid;">
                <div class="mat-row border_none flex-box flex-box">
                  <div class="mat-cell pab_table_head pb_tb_hd green_th flex1 width-200">Branch Name</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th flex2  width-200">Branch Type</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th flex3 width-100">Effective Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th flex4 width-100">Expiry Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th flex5 width-200">Vehicle Assigned</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let branch of previewList?.branchAllocationPrev; let i = index"  style="page-break-inside: avoid;">
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex1 pab_table_dis2 green_th  width-200">{{branch?.branchName == null ? 'NA' : branch.branchName}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex2 width-200">{{branch?.branchType == null ?  'NA'  : branch.branchType}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex3 width-100">{{branch?.efftvDate == null ?  'NA'  : branch.efftvDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex4 width-100">{{branch?.exprDate == null ?  'NA'  : branch.exprDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex5 width-200">{{branch?.assignedVehicle == null ?  'NA'  : branch.assignedVehicle }}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4  width-800">
          <h3  style="page-break-inside: avoid;"><strong>Payment Terms</strong></h3>
          <div class="row payment_base_t"  style="page-break-inside: avoid;">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Payment Based On</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName == null ?  '' : previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Expense Type</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}}</div>
                </div>
              </div>
            </div>
          </div>
          <!-- If payout based on BOOKING start-->
          <div class="row" *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'BOOKING'">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl  preview_table_2"  style="page-break-inside: avoid;">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head flex1 width-200">Service Offering</div>
                  <div class="mat-cell pab_table_head flex2 width-200">Credit</div>
                  <div class="mat-cell pab_table_head flex3 width-200">Paid</div>
                  <div class="mat-cell pab_table_head flex4 width-200">To Day</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let data of uniqueOfferings; let i = index"  style="page-break-inside: avoid;">
                  <div class="mat-cell pab_table_dis1 pab_table_dis2 flex1 width-200">{{data.serviceLookup == null ? 'NA' : data.serviceLookup}}</div>
                  <div class="mat-cell pab_table_dis1 flex2 width-200">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'â‚¹'}} {{data.creditAmt == null ? 'NA' : data.creditAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</div>
                  <div class="mat-cell pab_table_dis1 flex3 width-200">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'â‚¹'}} {{data.paidAmt == null ? 'NA' : data.paidAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</div>
                  <div class="mat-cell pab_table_dis1 flex4 width-200">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'â‚¹'}} {{data.toPayAmt == null ? 'NA' : data.toPayAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</div>
                </div>
              </div>
            </div>
          </div>
          <!-- If payout based on BOOKING end-->

          <!-- If payout based on PERTRIP start-->
          <div class="row" *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'PERTRIP' && previewList?.paymentTermsPrev?.serviceOffrnPrev.length > 0">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl  preview_table_2"  style="page-break-inside: avoid;">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head flex3 green_th">VEHICLE MODEL</div>
                  <div class="mat-cell pab_table_head flex4 green_th">RATE</div>
                </div>
                <div class="mat-row border_none flex-box"  style="page-break-inside: avoid;" *ngFor="let trip of previewList?.paymentTermsPrev?.serviceOffrnPrev; let i = index">
                  <div class="mat-cell pab_table_dis1 pab_table_dis2 flex3">{{trip.lkpCargoCapacityId == null ? 'NA' : trip.lkpCargoCapacityId | lookupValue : "lookupVal" : previewRefList.vehicleCargoCapacityList}}</div>
                  <div class="mat-cell pab_table_dis1 flex4">{{trip.price == null ? 'NA' : trip.price}}</div>
                </div>
              </div>
            </div>
          </div>
          <!-- If payout based on PERTRIP end-->

          <!-- If payout based on OFFERING start-->
          <div class="row" *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'OFFERING'">
            <div class="col-md-9">
              <div class="mat-table prvw_tbl  preview_table_2">
                <div class="mat-row border_none flex-box"  style="page-break-inside: avoid;"> 
                  <div class="mat-cell pab_table_head col-print-2 pab_table_dis2 flex3 green_th">EXPENSE TYPE</div>
                  <div class="mat-cell pab_table_dis1 col-print-2 pab_table_dis2 flex4 green_th">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}}</div>
                  
                </div>
                <div class="mat-row border_none flex-box"  style="page-break-inside: avoid;" *ngFor="let offer of previewList?.paymentTermsPrev?.serviceOffrnPrev; let i = index">
                  <div class="mat-cell pab_table_head col-print-1 flex3 green_th">
                    {{offer.serviceOfferingId == null ? 'NA' : offer.serviceOfferingId | lookupValue : "serviceOffering" : previewRefList.serviceOfferingList}}
                  </div>
                  <div class="mat-cell pab_table_dis1 col-print-1 flex4">{{offer.price == null ? 'NA' : offer.price}}</div>
                </div>
              </div>
            </div>
          </div>
          <!-- If payout based on OFFERING end-->
          <div class="row payment_base_t"  style="page-break-inside: avoid;">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Per Waybill Min</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹  {{previewList?.paymentTermsPrev?.minAmtPerWaybl == null ? '0' : previewList?.paymentTermsPrev?.minAmtPerWaybl}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Additional Parameter</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Amount</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹ {{previewList?.paymentTermsPrev?.addtnlParamVal == null ? '0' : previewList?.paymentTermsPrev?.addtnlParamVal}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">End Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.expDt == null ? 'NA' : previewList?.paymentTermsPrev?.expDt | date: 'dd/MM/yyyy' }}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Per Waybill Max</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹  {{previewList?.paymentTermsPrev?.maxAmtPerWaybl == null ? '0' : previewList?.paymentTermsPrev?.maxAmtPerWaybl }}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Parameter</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName }}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Start Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.effectiveDt == null ? 'NA' : previewList?.paymentTermsPrev?.effectiveDt | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4 preview_sec_5  width-800"  style="page-break-inside: avoid;">
          <h3><strong>Ex - Gratia</strong></h3>
          <div class="row pb_15" style="margin-bottom: 1rem;">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3"><strong>Ex - Gratia Applicable</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.exgratiaFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
              </div>
            </div>
          </div>
          <div class="row"  *ngIf="(previewList?.paymentTermsPrev?.exgratiaFlag == 1)">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl preview_table_2 pb_td">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head pb_tb_hd flex1 width-200">Branch</div>
                  <div class="mat-cell pab_table_head pb_tb_hd flex2 width-200">Ex - Gratia Amount</div>
                  <div class="mat-cell pab_table_head pb_tb_hd flex3 width-200">Reason</div>
                  <div class="mat-cell pab_table_head pb_tb_hd flex4 width-100">Start Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd flex5 width-100">End Date</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let gratia of graciaList; let i = index">
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex1 pab_table_dis2 width-200">{{gratia.branchName == null ? 'NA' : gratia.branchName}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex2 width-200">â‚¹  {{gratia.amt == null ? '0' : gratia.amt}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex3 width-200">{{gratia.reason == null ? 'NA' : gratia.reason}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex4 width-100">{{gratia.efftvDate == null ? 'NA' : gratia.efftvDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd flex5 width-100">{{gratia.exprDate == null ? 'NA' : gratia.exprDate | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
          </div>
          <div class="row payment_base_t">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Promotion Applicable</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Customer Specific Payment</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.custPymtFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Additional Expense</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.addtnlExpnsFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3">Remarks</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.addtnlExpnsRemark ? previewList?.paymentTermsPrev?.addtnlExpnsRemark : 'NA'}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="width-800 preview_sec_3 preview_sec_4 preview_sec_5" *ngFor="let custData of previewList?.bookingCommercialCustomerPrev; let j=index" style="page-break-inside: avoid;">
          <div class="row">
            <div class="col-md-3">
              <div class="customer_preview">
                  <h4><strong>Customer:</strong> <span style="text-transform: uppercase;">{{custData.customerName == null ? 'NA' : custData.customerName}}</span></h4>
                  <h4><strong>SFX/ PRC Code:</strong> {{custData.cntrCode == null ? 'NA' : custData.cntrCode}}</h4>
              </div>
            </div>
          </div>
          <div class="row payment_base_t preview_sec_4 preview_sec_5">
            <div class="col-md-5">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Payout Based On</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData.lkpAssocBkngPayoutCtgyName == null ? 'NA' : custData.lkpAssocBkngPayoutCtgyName}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-5 col-md-offset-2">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Expense Type</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData.lkpAssocBkngExpnsTypeName == null ? 'NA' : custData.lkpAssocBkngExpnsTypeName}}</div>
                </div>
              </div>
            </div>
          </div>
        <!-- BOOKING Start -->
        <div class="row" *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'BOOKING'">
          <div class="col-md-9">
            <div class="mat-table prvw_tbl  preview_table_2">
              <div class="mat-row border_none flex-box">
                <div class="mat-cell pab_table_head flex1 width-200">Service Offering</div>
                <div class="mat-cell pab_table_head flex2 width-200">Credit</div>
                <div class="mat-cell pab_table_head flex3 width-200">Paid</div>
                <div class="mat-cell pab_table_head flex4 width-200">To Day</div>
              </div>
              <div class="mat-row border_none flex-box" *ngFor="let custService of uniqueOfferingsForCustomer[j]; let i = index">
                <div class="mat-cell pab_table_dis1 flex1 pab_table_dis2 width-200">{{custService.serviceLookup == null ? 'NA' : custService.serviceLookup}}</div>
                <div class="mat-cell pab_table_dis1 flex2 width-200">â‚¹  {{custService.creditAmt == null ? '0' : custService.creditAmt}} / PCKG</div>
                <div class="mat-cell pab_table_dis1 flex3 width-200">â‚¹  {{custService.paidAmt == null ? '0' : custService.paidAmt}} / PCKG</div>
                <div class="mat-cell pab_table_dis1 flex4 width-200">â‚¹  {{custService.toPayAmt == null ? '0' : custService.toPayAmt}} / PCKG</div>
              </div>
            </div>
          </div>
        </div>
        <!-- BOOKING End -->

        <!-- If payout based on PERTRIP start-->
        <div class="row" *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'PERTRIP' && custData?.serviceOffrnPrev?.length > 0">
          <div class="col-md-9">
            <div class="mat-table prvw_tbl  preview_table_2">
              <div class="mat-row border_none flex-box">
                <div class="mat-cell pab_table_head flex3">VEHICLE MODEL</div>
                <div class="mat-cell pab_table_head flex4">RATE</div>
              </div>
              <div class="mat-row border_none flex-box" *ngFor="let trip of custData?.serviceOffrnPrev; let i = index">
                <div class="mat-cell pab_table_dis1 flex3 pab_table_dis2 green_th">{{trip.lkpCargoCapacityId == null ? 'NA' : trip.lkpCargoCapacityId | lookupValue : "lookupVal" : previewRefList.vehicleCargoCapacityList}}</div>
                <div class="mat-cell pab_table_dis1 flex4 green_th">{{trip.price == null ? 'NA' : trip.price}}</div>
              </div>
            </div>
          </div>
        </div>
        <!-- If payout based on PERTRIP end-->

        <!-- If payout based on OFFERING start-->
        <div class="row" *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'OFFERING'">
          <div class="col-md-9">
            <div class="mat-table prvw_tbl  preview_table_2">
              <div class="mat-row border_none flex-box">
                <div class="mat-cell pab_table_head col-print-2 pab_table_dis2 flex3 green_th">EXPENSE TYPE</div>
                <div class="mat-cell pab_table_dis1 col-print-2 pab_table_dis2 flex4 green_th">{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}}</div>
                
              </div>
              <div class="mat-row border_none flex-box" *ngFor="let offer of previewList?.paymentTermsPrev?.serviceOffrnPrev; let i = index">
                <div class="mat-cell pab_table_head col-print-1 flex3 green_th">
                  {{offer.serviceOfferingId == null ? 'NA' : offer.serviceOfferingId | lookupValue : "serviceOffering" : previewRefList.serviceOfferingList}}
                </div>
                <div class="mat-cell pab_table_dis1 col-print-1 flex4">{{offer.price == null ? 'NA' : offer.price}}</div>
              </div>
            </div>
          </div>
        </div>
        <!-- If payout based on OFFERING end-->

          <div class="row payment_base_t">
            <div class="col-md-5">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Per Waybill Min</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹  {{custData.minAmtPerWaybl == null ? '0' : custData.minAmtPerWaybl}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Additional Parameter</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Amount</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹ {{custData.addtnlParamVal == null ? '0' : custData.addtnlParamVal}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">End Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData.expDt == null ? 'NA' : custData.expDt | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-5 col-md-offset-2">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Per Waybill Max</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹  {{custData.maxAmtPerWaybl == null ? '0' : custData.maxAmtPerWaybl}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Parameter</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData?.lkpAssocAddtnlParamId == null ? 'NA' : custData?.lkpAssocAddtnlParamId}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Start Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{custData.effectiveDt == null ? 'NA' : custData.effectiveDt | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4 preview_sec_5  width-800" style="page-break-inside: avoid;">
          <h3><strong>Minimum Guarantee</strong></h3>
          <div class="row pb_15">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>MG Applicable</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.paymentTermsPrev?.minGuaranteeFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6"></div>
          </div>
          <div class="row" *ngIf="(previewList?.paymentTermsPrev?.minGuaranteeFlag == 1)">
            <br>
            <div class="col-md-12">
              <div class="mat-table prvw_tbl  preview_table_2">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head green_th  width-200">Branch</div>
                  <div class="mat-cell pab_table_head green_th width-200">MG Amount</div>
                  <div class="mat-cell pab_table_head green_th width-200">Reason</div>
                  <div class="mat-cell pab_table_head green_th width-100">Start Date</div>
                  <div class="mat-cell pab_table_head green_th width-100">End Date</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let gratia of mgList; let i = index">
                  <div class="mat-cell pab_table_dis1 pab_table_dis2 width-200">{{gratia.branchName == null ? 'NA' : gratia.branchName}}</div>
                  <div class="mat-cell pab_table_dis1 width-200">â‚¹  {{gratia.amt == null ? '0' : gratia.amt}}</div>
                  <div class="mat-cell pab_table_dis1 width-200">{{gratia.reason == null ? 'NA' : gratia.reason}}</div>
                  <div class="mat-cell pab_table_dis1 width-100">{{gratia.efftvDate == null ? 'NA' : gratia.efftvDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 width-100">{{gratia.exprDate == null ? 'NA' : gratia.exprDate |  date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4  width-800" style="page-break-inside: avoid;">
          <h3><strong>Deductions</strong></h3>
          <div class="row payment_base_t">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>SLA Applicable</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.slaFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Penalty Against Wrong Dimensions</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.wrongDimFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Sla Deduction For Late Arrival To Hub</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.lateArrFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Penalty Against Wrong Weight</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.wrongWtFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Penalty Against Waybill</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.wrongWayblFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th"><strong>Market Vehicle Expense</strong></div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.mktVehicleExpenseFlag === 1 ? 'Yes' : 'No'}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="preview_sec_3 preview_sec_4 preview_sec_5  width-800" style="page-break-inside: avoid;">
          <h3><strong>EMI Deduction Calculation</strong></h3>
          <div class="row">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl  preview_table_2 pb_tb">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Vehicle No.</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Emi Amount</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-100">Start Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-100">End Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Branch ID</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let vehicle of emiList; let i = index">
                  <div class="mat-cell pab_table_dis1 pb_tb_hd pab_table_dis2 width-200">{{vehicle.vehicleName == null ? 'NA' : vehicle.vehicleName}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-200">â‚¹  {{vehicle.amt == null ? '0' : vehicle.amt}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-100">{{vehicle.efftvDate == null ? 'NA' : vehicle.efftvDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-100">{{vehicle.exprDate == null ? 'NA' : vehicle.exprDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-200">{{vehicle.branchName == null ? 'NA' : vehicle.branchName}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4 preview_sec_5  width-800" style="page-break-inside: avoid;">
          <h3><strong>Insurance Deduction Calculation</strong></h3>
          <div class="row">
            <div class="col-md-12">
              <div class="mat-table prvw_tbl  preview_table_2 pb_tb">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Vehicle No.</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Amount</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-100">Start Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-100">End Date</div>
                  <div class="mat-cell pab_table_head pb_tb_hd green_th width-200">Branch ID</div>
                </div>
                <div class="mat-row border_none flex-box" *ngFor="let vehicle of insuranceList; let i = index">
                  <div class="mat-cell pab_table_dis1 pb_tb_hd pab_table_dis2 width-200">{{vehicle.vehicleName == null ? 'NA' : vehicle.vehicleName}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-200">â‚¹  {{vehicle.amt == null ? '0' : vehicle.amt}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-100">{{vehicle.efftvDate == null ? 'NA' : vehicle.efftvDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-100">{{vehicle.exprDate == null ? 'NA' : vehicle.exprDate | date: 'dd/MM/yyyy'}}</div>
                  <div class="mat-cell pab_table_dis1 pb_tb_hd width-200">{{vehicle.branchName == null ? 'NA' : vehicle.branchName}}</div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="preview_sec_3 preview_sec_4 preview_sec_5  width-800" style="page-break-inside: avoid;">
          <h3><strong>Advance Amount Applicable</strong></h3>
          <div class="row">
            <div class="col-md-6">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Advance Amount Applicable</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.advncDedctnAmtFlag ===1 ? 'YES' : 'NO'}}</div>
                </div>
                <div class="mat-row border_none flex-box" *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Start Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.advncDedctnAmtFromDt == null ? 'NA' : previewList?.bookingDeductionPrev?.advncDedctnAmtFromDt | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-6" *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">
              <div class="mat-table prvw_tbl  preview_table_1">
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">Advance Amount to be Deducted</div>
                  <div class="mat-cell preview_table_bg_2 flex4">â‚¹ {{previewList?.bookingDeductionPrev?.advncDedctnAmt == null ? '0' : previewList?.bookingDeductionPrev?.advncDedctnAmt}}</div>
                </div>
                <div class="mat-row border_none flex-box">
                  <div class="mat-cell preview_table_bg_1 flex3 green_th">end Date</div>
                  <div class="mat-cell preview_table_bg_2 flex4">{{previewList?.bookingDeductionPrev?.advncDedctnAmtToDt == null ? 'NA' : previewList?.bookingDeductionPrev?.advncDedctnAmtToDt | date: 'dd/MM/yyyy'}}</div>
                </div>
              </div>
            </div>
          </div>
          <hr class="billingHr">
        </section>
      </div>
      <section class="mgsg_print_sec">
        <div class="row" style="position: relative;">
          <div class="col-md-3">
            <div class="row">
              <div class="col-md-6">
                <p style="cursor: pointer !important;" (click)="sendEmail()"><img alt="image" src="../assets/images/envelope.png"> <strong>Email</strong></p>
              </div>
              <div class="col-md-6">
                  <button style="cursor: pointer !important;width: 12rem;font-size: 2.8rem; border: none; background: transparent;left:0; top: 0.7rem; display: flex;" [useExistingCss]="true"
                  printTitle="{{previewList?.companyName}}" printSectionId="previewContent" ngxPrint> <img alt="print" src="../assets/images/printer.png"> <p style="font-weight: bold;">Print</p></button>
              </div>
            </div>
          </div> 
          <div class="col-md-1 col-md-offset-7" *ngIf="!editflow">
            <button mat-button class="theme-button" *ngxPermissionsOnly="['VIEW CONTRACT_CREATE','VIEW CONTRACT_UPDATE']" (click)="sendContractId($event)">Submit</button>
          </div>
          <div class="col-md-3 col-md-offset-6" *ngIf="editflow">
            <button mat-button class="theme-button pull-right" *ngxPermissionsOnly="['VIEW CONTRACT_CREATE','VIEW CONTRACT_UPDATE']" (click)="openEditPreview()">Verify Updated Changes</button>
          </div>
            <div class="backButton" (click)="closePreview($event)">
              <span>
                <mat-icon>close</mat-icon>
              </span>
            </div>
        </div>
      </section>
    </div>
  </div>
</section>
<ngx-spinner id="spinner" size="large" type="ball-spin-clockwise">
</ngx-spinner>



























<!-- only for prit use -->
<!-- for print only naresh -->
<div class="previewHeading" style="display: none;" id="printing">
  <h2>Booking Associate Contract</h2>
  




    <!-- customer details -->
  <table aria-describedby="table" class="table_" id="Booking Associate Contract">
    <tbody>
        <tr>
          <th scope="col" style="width:400px">-</th>
          <th scope="col" style="width:400px">--</th>
        </tr>
        <tr>
          <td style="width:400px">Organisation Name:  {{previewList?.companyName == null ? 'NA' : previewList?.companyName}}</td>
          <td style="width:400px">Associate Category: {{previewList?.asscoCtrgy == null ? 'NA' : previewList?.asscoCtrgy}} </td>
         
        </tr>
        <tr>
          <td style="width:400px"> Contract Code: {{previewList?.cntrCode == null ? 'NA' : previewList?.cntrCode}}</td>
          <td style="width:400px"> W.E.F: {{previewList?.wefDate == null ? 'NA' : previewList?.wefDate | date: 'dd/MM/yyyy'}} </td>
        </tr>       
      </tbody>
    </table>
    <!-- end customer details -->



    <!-- Contract Details -->
    <table aria-describedby="table" class="table_ fourCol" id="Contract Details">
      <tbody>
        <tr>
          <th scope="col" style="width:400px">-</th>
          <th scope="col" style="width:400px">--</th>
          <th scope="col" style="width:400px">---</th>
          <th scope="col" style="width:400px">----</th>
        </tr>
        <tr>
          <td style="width:400px">Start Date </td>
          <td>{{previewList?.effectiveDt == null ? 'NA' : previewList?.effectiveDt | date: 'dd/MM/yyyy'}}</td>
          <td>Billing Cycle</td>
          <td style="width:400px">{{previewList?.billingCyle == null ? 'NA' : previewList?.billingCyle}}</td>
        </tr>
        <tr>
          <td style="width:400px">End Date</td>
          <td>{{previewList?.expDt == null ? 'NA' : previewList?.expDt | date: 'dd/MM/yyyy'}}</td>
          <td style="width:400px">Status</td>
          <td>{{previewList?.cntrctStatus == "EDIT" ? "ACTIVE" : previewList?.cntrctStatus}}</td>
        </tr>
        <tr>
          <td style="width:400px">Shuttle Vendor</td>
          <td style="width:400px"> {{previewList?.shuttleVendorFlag === 1 ? 'YES' : 'NO'}} </td>
          <td style="width:400px"></td>
          <td style="width:400px"></td>
        </tr>

    
      </tbody>
    </table>
    <!-- end Contract Details -->




  <!-- Branch -->
  <table aria-describedby="table" class="table_ fiveCol" data-heading="show" id="Allocation" >
      <tbody>
        <tr>
          <th scope="col">Branch Name </th>
          <th scope="col">Branch Type </th>
          <th scope="col">Effective Date </th>
          <th scope="col">Expiry Date </th>
          <th scope="col">Vehicle Assigned </th>
        </tr>
        <tr *ngFor="let branch of previewList?.branchAllocationPrev; let i = index">
          <td> {{branch.branchName == null ? 'NA' : branch.branchName}} </td>
          <td > {{branch.branchType == null ? 'NA' : branch.branchType}} </td>
          <td> {{branch.efftvDate == null ? 'NA' : branch.efftvDate | date: 'dd/MM/yyyy'}} </td>
          <td> {{branch.exprDate == null ? 'NA' : branch.exprDate | date: 'dd/MM/yyyy'}} </td>
          <td> {{branch.assignedVehicle == null ? 'NA' : branch.assignedVehicle}} </td>
        </tr>
      </tbody>
  </table>



  <!-- Payment Terms -->
  <table  aria-describedby="table h5" class="table_  fourCol"  id="Payment Terms">
    <tbody>
      <tr>
        <th scope="col">- </th>
        <th scope="col">-- </th>
        <th scope="col">-- -</th>
        <th scope="col">-- --</th>
      </tr>
      <tr>
        <td> Payment Based On</td>
        <td>{{previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName}}</td> 
        <td>Expense Type </td>
        <td>{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}} </td>
      </tr>
    </tbody>
</table>



 <!-- If payout based on BOOKING start-->
  <table aria-describedby="table h5" class="table_ fourColWithHead"  data-heading="show"  *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'BOOKING'">
    <tbody>
      <tr>
        <th scope="col">Service Offering </th>
        <th scope="col">Credit </th>
        <th scope="col">Paid </th>
        <th scope="col">To Day </th>
      </tr>
      <tr *ngFor="let data of uniqueOfferings; let i = index">
        <td> {{data?.serviceLookup == null ? 'NA' : data?.serviceLookup}}</td>
        <td >{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'Rs.'}} {{data?.creditAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</td>
        <td >{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'Rs.'}} {{data?.paidAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</td>
        <td >{{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '%' : 'Rs.'}} {{data?.toPayAmt}} {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'FRIEGHT OF WAYBILL' ? '' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == 'PER TRIP' ? '/TRIP' : '/PCKG'}}</td>
      </tr>
    </tbody>
</table>


 <!-- If payout based on PERTRIP start-->
 <table aria-describedby="table h5" class="table_ twoCol"  data-heading="show" *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'PERTRIP' && previewList?.paymentTermsPrev?.serviceOffrnPrev.length > 0" >
  <tbody>
    <tr>
      <th scope="col">VEHICLE MODEL </th>
      <th scope="col">RATE </th>
    </tr>
    <tr *ngFor="let trip of previewList?.paymentTermsPrev?.serviceOffrnPrev; let i = index">
      <td> {{trip.lkpCargoCapacityId == null ? 'NA' : trip.lkpCargoCapacityId | lookupValue : "lookupVal" : previewRefList.vehicleCargoCapacityList}}</td>
      <td >{{trip.price == null ? 'NA' : trip.price }}</td>
    </tr>
  </tbody>
</table>






 <!-- If payout based on OFFERING start-->
 <table aria-describedby="table h5" class="table_  twoCol"  data-heading="show" *ngIf="previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName === 'OFFERING'" >
  <tbody>
    <tr>
      <th scope="col">EXPENSE TYPE </th>
      <th scope="col"> {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}}</th>
    </tr>
    <tr *ngFor="let offer of previewList?.paymentTermsPrev?.serviceOffrnPrev; let i = index">
      <td>{{offer.serviceOfferingId == null ? 'NA' : offer.serviceOfferingId | lookupValue : "serviceOffering" : previewRefList.serviceOfferingList}} </td>
      <td>{{offer.price == null ? 'NA' : offer.price}}</td>
    </tr>
  </tbody>
</table>
 




 <table aria-describedby="table h5" class="table_  fourCol">
  <tbody>
    <tr>
      <th scope="col">-</th>
      <th scope="col">--</th>
      <th scope="col">---</th>
      <th scope="col">----</th>
    </tr>
    <tr>
      <td>Per Waybill Min</td>
      <td>Rs. : {{previewList?.paymentTermsPrev?.minAmtPerWaybl == null ? '0' : previewList?.paymentTermsPrev?.minAmtPerWaybl}}</td>

      <td>Per Waybill Max </td>
      <td>Rs. {{previewList?.paymentTermsPrev?.maxAmtPerWaybl == null ?  '0' : previewList?.paymentTermsPrev?.maxAmtPerWaybl}}</td>
    </tr>
    <tr>      
      <td>Additional Parameter</td>
      <td>{{previewList?.paymentTermsPrev?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</td>      
      <td>Parameter</td>
      <td>{{previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngPayoutCtgyName}}</td>      
    </tr>
    <tr>
      <td>Amount</td>
      <td>Rs. {{previewList?.paymentTermsPrev?.addtnlParamVal == null ? '0' : previewList?.paymentTermsPrev?.addtnlParamVal}}</td>
      <td>Start Date</td>
      <td> {{previewList?.paymentTermsPrev?.effectiveDt == null ? 'NA' : previewList?.paymentTermsPrev?.effectiveDt | date: 'dd/MM/yyyy'}}</td>
    </tr>
    <tr>
      <td>End Date</td>
      <td>{{previewList?.paymentTermsPrev?.expDt == null ? 'NA' : previewList?.paymentTermsPrev?.expDt | date: 'dd/MM/yyyy' }}</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>





  <!-- Ex - Gratia -->
  <table  aria-describedby="table h5" class="table_ h5 fourCol" id="Ex - Gratia"  data-page="newPage">
    <tbody>
      <tr>
        <th scope="col">- </th>
        <th scope="col">-- </th>
        <th scope="col">-- -</th>
        <th scope="col">-- --</th>
      </tr>
      <tr>
        <td> Ex - Gratia Applicable</td>
        <td>{{previewList?.paymentTermsPrev?.exgratiaFlag === 1 ? 'Yes' : 'No'}}</td> 
        <td> </td>
        <td> </td>
      </tr>
    </tbody>
</table>







 <table aria-describedby="table" class="table_  fiveCol"  data-heading="show"  *ngIf="(previewList?.paymentTermsPrev?.exgratiaFlag == 1)" >
  <tbody>
    <tr>
      <th scope="col">Branch </th>
      <th scope="col">Ex - Gratia Amount </th>
      <th scope="col">Reason</th>
      <th scope="col">Start Date</th>
      <th scope="col">End Date</th>
    </tr>
    <tr *ngFor="let gratia of graciaList; let i = index">
      <td> {{gratia.branchName == null ? 'NA' : gratia.branchName}}</td>
      <td>Rs. {{gratia.amt == null ? '0' : gratia.amt}}</td>
      <td>{{gratia.reason == null ? 'NA' : gratia.reason}}</td>
      <td>{{gratia.efftvDate == null ? 'NA' : gratia.efftvDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{gratia.exprDate == null ? 'NA' : gratia.exprDate | date: 'dd/MM/yyyy'}}</td>
    </tr>
  </tbody>
</table>




<table aria-describedby="table" class="table_ fourCol">
  <tbody>
    <tr>
      <th scope="col">-</th>
      <th scope="col">--</th>
      <th scope="col">---</th>
      <th scope="col">----</th>
    </tr>
    <tr>
      <td>Promotion Applicable</td>
      <td>{{previewList?.paymentTermsPrev?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</td>
      <td>Additional Expense </td>
      <td>{{previewList?.paymentTermsPrev?.custPymtFlag === 1 ? 'Yes' : 'No'}}</td>
    </tr>
    <tr>
      <td>Customer Specific Payment</td>
      <td>{{previewList?.paymentTermsPrev?.custPymtFlag === 1 ? 'Yes' : 'No'}}</td>
      <td>Remarks </td>
      <td>{{previewList?.paymentTermsPrev?.addtnlExpnsRemark == null ? 'NA' : previewList?.paymentTermsPrev?.addtnlExpnsRemark}}</td>
    </tr>
  </tbody>
</table>



<div *ngFor="let custData of previewList?.bookingCommercialCustomerPrev; let j=index">
  <table aria-describedby="table h5 " class="table_ customersTable">
    <tbody>
      <tr>
        <th scope="col">-</th>
        <th scope="col">--</th>
        <th scope="col">--</th>
        <th scope="col">--</th>
      </tr>
      <tr>
        <td>Customer:</td>
        <td>{{custData?.customerName == null ? 'NA' : custData?.customerName}}</td>
        <td>SFX/ PRC Code: </td>
        <td>{{custData?.cntrCode == null ? 'NA' : custData?.cntrCode}}</td>
      </tr>     
    </tbody>
  </table>



  <table aria-describedby="table " class="table_  fourCol">
    <tbody>
      <tr>
        <th scope="col">-</th>
        <th scope="col">--</th>
        <th scope="col">---</th>
        <th scope="col">----</th>
      </tr>
      <tr>
        <td>Payout Based On</td>
        <td>{{custData?.lkpAssocBkngPayoutCtgyName == null ? 'NA' : custData?.lkpAssocBkngPayoutCtgyName}}</td>
        <td>Expense Type </td>
        <td>{{custData?.lkpAssocBkngExpnsTypeName == null ? 'NA' : custData?.lkpAssocBkngExpnsTypeName}}</td>
      </tr>
    </tbody>
  </table>


  <!-- BOOKING Start -->
  <table aria-describedby="table " class="table_  fourColWithHead"  data-heading="show"  *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'BOOKING'" >
    <tbody>
      <tr>
        <th scope="col">Service Offering </th>
        <th scope="col">Credit </th>
        <th scope="col">Paid</th>
        <th scope="col">To Day</th>
      </tr>
      <tr *ngFor="let custService of uniqueOfferingsForCustomer[j]; let i = index">
        <td> {{custService.serviceLookup == null ? 'NA' : custService.serviceLookup}}</td>
        <td>Rs. {{custService.creditAmt == null ? '0' : custService.creditAmt}} / PCKG</td>
        <td>Rs. {{custService.paidAmt == null ? '0' : custService.paidAmt}} / PCKG</td>
        <td>Rs. {{custService.toPayAmt == null ? '0' : custService.toPayAmt}} / PCKG</td>
      </tr>
    </tbody>
  </table>
  <!-- BOOKING end -->



       <!-- If payout based on PERTRIP start-->
    <table aria-describedby="table h5" class="table_  twoCol"  data-heading="show"  *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'PERTRIP' && custData?.serviceOffrnPrev?.length > 0" >
      <tbody>
        <tr>
          <th scope="col">VEHICLE MODEL</th>
          <th scope="col">RATE</th>
        </tr>
        <tr *ngFor="let trip of custData?.serviceOffrnPrev; let i = index">
          <td> {{trip?.lkpCargoCapacityId == null ? 'NA' : trip?.lkpCargoCapacityId | lookupValue : "lookupVal" : previewRefList.vehicleCargoCapacityList}}</td>
          <td>{{trip?.price == null ? 'NA' : trip?.price}}</td>
        </tr>
      </tbody>
    </table>
      <!-- end If payout based on PERTRIP start-->




    <!-- If payout based on OFFERING start-->
    <table aria-describedby="table " class="table_  twoCol"  data-heading="show"  *ngIf="custData?.lkpAssocBkngPayoutCtgyName === 'OFFERING'" >
      <tbody>
        <tr>
          <th scope="col">EXPENSE TYPE</th>
          <th scope="col"> {{previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName == null ? 'NA' : previewList?.paymentTermsPrev?.lkpAssocBkngExpnsTypeName}}</th>
        </tr>
        <tr *ngFor="let offer of custData?.serviceOffrnPrev; let i = index">
          <td> {{offer?.serviceOfferingId == null ? 'NA' : offer?.serviceOfferingId | lookupValue : "serviceOffering" : previewRefList.serviceOfferingList}}</td>
          <td>{{offer?.price == null ? 'NA' : offer?.price}}</td>
        </tr>
      </tbody>
    </table>
    <!-- end If payout based on OFFERING start-->


    <table aria-describedby="table " class="table_ h5 fourCol">
      <tbody>
        <tr>
          <th scope="col">-</th>
          <th scope="col">--</th>
          <th scope="col">---</th>
          <th scope="col">----</th>
        </tr>
        <tr>
          <td>Per Waybill Min</td>
          <td>Rs. {{custData?.minAmtPerWaybl == null ? '0' : custData?.minAmtPerWaybl}}</td>
          <td>Per Waybill Max </td>
          <td>Rs. {{custData?.maxAmtPerWaybl == null ? '0' : custData?.maxAmtPerWaybl}}</td>
        </tr>
        <tr>
          <td>Additional Parameter</td>
          <td>{{custData?.addtnlParamFlag === 1 ? 'Yes' : 'No'}}</td>
          <td>Parameter </td>
          <td>{{custData?.lkpAssocAddtnlParamId == null ? 'NA' : custData?.lkpAssocAddtnlParamId}}</td>
        </tr>
        <tr>
          <td>Amount</td>
          <td>Rs. {{custData?.addtnlParamVal == null ? '0' : custData?.addtnlParamVal}}</td>
          <td>Start Date </td>
          <td>{{custData?.effectiveDt == null ? 'NA' : custData?.effectiveDt | date: 'dd/MM/yyyy'}}</td>
        </tr>
        <tr>
          <td>End Date</td>
          <td>{{custData?.expDt == null ? 'NA' : custData?.expDt | date: 'dd/MM/yyyy'}}</td>
          <td> </td>
          <td></td>
        </tr>
      </tbody>
    </table>
</div>



<table aria-describedby="table" class="table_ h5 fourCol"  id="Minimum Guarantee">
  <tbody>
    <tr>
      <th scope="col">-</th>
      <th scope="col">--</th>
      <th scope="col">---</th>
      <th scope="col">----</th>
    </tr>
    <tr>
      <td>MG Applicable</td>
      <td>{{previewList?.paymentTermsPrev?.minGuaranteeFlag === 1 ? 'Yes' : 'No'}}</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>


<table aria-describedby="table" *ngIf="(previewList?.paymentTermsPrev?.minGuaranteeFlag == 1)" class="table_  fiveCol" data-heading="show" >
  <tbody>
    <tr>
      <th scope="col">Branch</th>
      <th scope="col">MG Amount</th>
      <th scope="col">Reason</th>
      <th scope="col">Start Date</th>
      <th scope="col">End Date</th>
    </tr>
    <tr *ngFor="let gratia of mgList; let i = index">
      <td>{{gratia.branchName == null ? 'NA' : gratia.branchName}}</td>
      <td>Rs. {{gratia.amt == null ? '0' : gratia.amt}}</td>
      <td>{{gratia.reason == null ? 'NA' : gratia.reason}}</td>
      <td>{{gratia.efftvDate == null ? 'NA' : gratia.efftvDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{gratia.exprDate == null ? 'NA' : gratia.exprDate | date: 'dd/MM/yyyy'}}</td>
    </tr>
  </tbody>
</table>



<table aria-describedby="table" class="table_  fourCol"  id="Deductions">
  <tbody>
    <tr>
      <th scope="col">-</th>
      <th scope="col">--</th>
      <th scope="col">---</th>
      <th scope="col">----</th>
    </tr>
    <tr>
      <td>SLA Applicable</td>
      <td>{{previewList?.bookingDeductionPrev?.slaFlag === 1 ? 'Yes' : 'No'}}</td>
      <td>Penalty Against Wrong Weight</td>
      <td>{{previewList?.bookingDeductionPrev?.wrongWtFlag === 1 ? 'Yes' : 'No'}}</td>
    </tr>
    <tr>
      <td>Penalty Against Wrong Dimensions</td>
      <td>{{previewList?.bookingDeductionPrev?.wrongDimFlag === 1 ? 'Yes' : 'No'}}</td>
      <td>Penalty Against Waybill</td>
      <td>{{previewList?.bookingDeductionPrev?.wrongWayblFlag === 1 ? 'Yes' : 'No'}}</td>
    </tr>
    <tr>
      <td>Sla Deduction For Late Arrival To Hub</td>
      <td>{{previewList?.bookingDeductionPrev?.lateArrFlag === 1 ? 'Yes' : 'No'}}</td>
      <td>Market Vehicle Expense</td>
      <td>{{previewList?.bookingDeductionPrev?.mktVehicleExpenseFlag === 1 ? 'Yes' : 'No'}}</td>
    </tr>
  </tbody>
</table>







<table aria-describedby="table"  id="EMI Deduction Calculation" class="table_  h5 fiveCol" data-heading="show" >
  <tbody>
    <tr>
      <th scope="col">Vehicle No.</th>
      <th scope="col">Emi Amount</th>
      <th scope="col">Start Date</th>
      <th scope="col">End Date</th>
      <th scope="col">Branch ID</th>
    </tr>
    <tr *ngFor="let vehicle of emiList; let i = index">
      <td>{{vehicle.vehicleName == null ? 'NA' : vehicle.vehicleName}}</td>
      <td>Rs. {{vehicle.amt == null ? '0' : vehicle.amt}}</td>
      <td>{{vehicle.efftvDate == null ? 'NA' : vehicle.efftvDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{vehicle.exprDate == null ? 'NA' : vehicle.exprDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{vehicle.branchName == null ? 'NA' : vehicle.branchName}}</td>
    </tr>
  </tbody>
</table>



<table aria-describedby="table"  id="Insurance Deduction Calculation" class="table_ h5  fiveCol" data-heading="show" >
  <tbody>
    <tr>
      <th scope="col">Vehicle No.</th>
      <th scope="col">Amount</th>
      <th scope="col">Start Date</th>
      <th scope="col">End Date</th>
      <th scope="col">Branch ID</th>
    </tr>
    <tr *ngFor="let vehicle of insuranceList; let i = index">
      <td>{{vehicle.vehicleName == null ? 'NA' : vehicle.vehicleName }}</td>
      <td>Rs. {{vehicle.amt == null ? '0' : vehicle.amt}}</td>
      <td>{{vehicle.efftvDate  == null ? 'NA' : vehicle.efftvDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{vehicle.exprDate == null ? 'NA' : vehicle.exprDate | date: 'dd/MM/yyyy'}}</td>
      <td>{{vehicle.branchName == null ? 'NA' : vehicle.branchName}}</td>
    </tr>
  </tbody>
</table>

<table aria-describedby="table"  id="Advance Amount Applicable" class="table_ h5  fourCol"  >
  <tbody>
    <tr>
      <th scope="col">-</th>
      <th scope="col">--</th>
      <th scope="col">---</th>
      <th scope="col">---</th>
    </tr>
    <tr>
      <td>Advance Amount Applicable</td>
      <td>{{previewList?.bookingDeductionPrev?.advncDedctnAmtFlag ===1 ? 'YES' : 'NO'}}</td>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">Advance Amount to be Deducted</span></td>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1"> Rs. {{previewList?.bookingDeductionPrev?.advncDedctnAmt == null ? '0' : previewList?.bookingDeductionPrev?.advncDedctnAmt}}</span></td>
    </tr>


    <tr>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">Start Date</span></td>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">{{previewList?.bookingDeductionPrev?.advncDedctnAmtFromDt == null ? 'NA' : previewList?.bookingDeductionPrev?.advncDedctnAmtFromDt | date: 'dd/MM/yyyy'}}</span></td>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">End Date</span></td>
      <td><span *ngIf="previewList?.bookingDeductionPrev?.advncDedctnAmtFlag==1">{{previewList?.bookingDeductionPrev?.advncDedctnAmtToDt == null ? 'NA' : previewList?.bookingDeductionPrev?.advncDedctnAmtToDt | date: 'dd/MM/yyyy'}}</span></td>
    </tr>
     

  </tbody>
</table>




</div>
